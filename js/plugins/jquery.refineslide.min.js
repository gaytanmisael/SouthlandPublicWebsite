/*
    jQuery Swipe Events * http://eikes.github.com/jquery.swipe-events.js
    jQuery RefineSlide plugin v0.3 (slightly modified) * http://github.com/alexdunphy/refineslide
*/
(function(a){a.fn.swipeEvents=function(){return this.each(function(){function e(a){var b=a.originalEvent.touches;b&&b.length&&(c=b[0].pageX,d.bind("touchmove",f))}function f(a){a.preventDefault();var b=a.originalEvent.touches;if(b&&b.length){var e=c-b[0].pageX;e>=50&&d.trigger("swipeLeft"),-50>=e&&d.trigger("swipeRight"),Math.abs(e)>=50&&d.unbind("touchmove",f)}}function g(){d.unbind("touchmove",f)}function h(){d.unbind("touchmove",f)}var b="ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch;if(b){var c,d=a(this);d.bind("touchstart",e),d.bind("touchend",g),d.bind("touchcancel",h)}})}})(jQuery),function(a,b,c,d){function f(b,c){this.$slider=a(b).addClass("rs-slider"),this.settings=a.extend({},e,c),this.$slides=this.$slider.find("> li"),this.totalSlides=this.$slides.length,this.cssTransitions=h.cssTransitions(),this.cssTransforms3d=h.cssTransforms3d(),this.currentPlace=this.settings.startSlide,this.$currentSlide=a(this.$slides[this.currentPlace]),this.inProgress=!1,this.$sliderWrap=this.$slider.wrap('<div class="rs-wrap" />').parent(),this.$sliderBG=this.$slider.wrap('<div class="rs-slide-bg" />').parent(),this.settings.slider=this,this.init()}function g(a,b,c){this.RS=a,this.RS.inProgress=!0,this.forward=c,this.transition=b,this.fallback3d=this.RS.settings.fallback3d,this.init()}var e={transition:"cubeH",fallback3d:"slideH",controls:"arrows",thumbsOnARow:0,autoPlay:!1,delay:5e3,transitionDuration:800,startSlide:0,keyNav:!1,captionWidth:50,arrowTemplate:'<div class="rs-arrows"><a href="#" class="rs-prev"><em></em></a><a href="#" class="rs-next"><em></em></a></div>',onInit:function(){},onChange:function(){},afterChange:function(){}};f.prototype={init:function(){var b=this;this.settings.onInit(),this.captions(),"arrows"===this.settings.controls&&this.setArrows(),this.settings.keyNav&&this.setKeys();for(var c=0;this.totalSlides>c;c++)a(this.$slides[c]).attr("class","rs-slide-"+c);this.settings.autoPlay&&(this.setAutoPlay(),this.$slider.on("mouseenter",function(){clearTimeout(b.cycling)}),this.$slider.on("mouseleave",function(){b.setAutoPlay()}));var d=a(this.$slides).find("img:eq(0)").addClass("rs-slide-image"),e=[];a(d).imagesLoaded(function(){for(var c=0;b.totalSlides>c;c++)e.push(a(d[c]).clone().css({position:"absolute",visibility:"hidden",display:"block"}).appendTo(b.$slider));setTimeout(function(){b.setup(e)},0)})},setup:function(b){for(var c=this,d=b.length;d--;)"thumbs"!==c.settings.controls&&a(b[d]).remove();"thumbs"===this.settings.controls&&this.setThumbs(b),this.$currentSlide.css({opacity:1,"z-index":2}),this.$sliderBG.prefixes({transform:"translateZ(0)"})},setArrows:function(){var b=this;this.$sliderBG.append(this.settings.arrowTemplate),a(".rs-next",this.$sliderWrap).on("click",function(a){a.preventDefault(),b.next(),b.settings.autoPlay=!1,clearTimeout(b.cycling)}),a(".rs-prev",this.$sliderWrap).on("click",function(a){a.preventDefault(),b.prev(),b.settings.autoPlay=!1,clearTimeout(b.cycling)}),this.$sliderWrap.swipeEvents().bind("swipeLeft",function(){b.next(),b.settings.autoPlay=!1,clearTimeout(b.cycling)}).bind("swipeRight",function(){b.prev(),b.settings.autoPlay=!1,clearTimeout(b.cycling)})},next:function(){this.currentPlace===this.totalSlides-1?this.transition(0,!0):this.transition(this.currentPlace+1,!0)},prev:function(){0==this.currentPlace?this.transition(this.totalSlides-1,!1):this.transition(this.currentPlace-1,!1)},setKeys:function(){var b=this;a(c).on("keydown",function(a){39===a.keyCode?(b.next(),b.settings.autoPlay=!1,clearTimeout(b.cycling)):37===a.keyCode&&(b.prev(),b.settings.autoPlay=!1,clearTimeout(b.cycling))})},setAutoPlay:function(){var a=this;this.cycling=setTimeout(function(){a.next()},this.settings.delay)},setThumbs:function(b){var c=this.settings.thumbsOnARow;0>=c&&(c=this.totalSlides);var d=this,e=100/c+"%";this.$thumbWrap=a('<div class="rs-thumb-wrap" />').appendTo(this.$sliderWrap);for(var f=0;this.totalSlides>f;f++){var g=a('<a class="rs-slide-link-'+f+'" />').css({width:e}).attr({href:"#"});a(b[f]).removeAttr("style").appendTo(this.$thumbWrap).wrap(g)}this.$thumbWrap.children().last().css("margin-right",-10),a(this.$thumbWrap.find("a")[this.settings.startSlide]).addClass("active"),this.$thumbWrap.on("click","a",function(b){b.preventDefault();var c=parseInt(a(this).attr("class").split("-")[3]);d.transition(c),d.settings.autoPlay=!1,clearTimeout(d.cycling)})},captions:function(){var b=this,c=this.$slides.find(".rs-caption");c.css({width:b.settings.captionWidth+"%",opacity:0}),this.$currentSlide.find(".rs-caption").css({opacity:1}),c.each(function(){a(this).prefixes({transition:"opacity "+b.settings.transitionDuration+"ms ease-in-out",transform:"translateZ(0)"})})},transition:function(b,c){this.inProgress||b!==this.currentPlace&&(c===d&&(c=b>this.currentPlace?!0:!1),this.$nextSlide=a(this.$slides[b]),this.currentPlace=b,this.settings.onChange(),new g(this,this.settings.transition,c),"thumbs"===this.settings.controls&&(this.$thumbWrap.find("a").removeClass("active"),a(this.$thumbWrap.find("a")[b]).addClass("active")))}},g.prototype={fallback:"fade",anims:["cubeH","cubeV","fade","sliceH","sliceV","slideH","slideV","scale","blockScale","kaleidoscope","fan","blindH","blindV"],init:function(){this[this.transition]()},before:function(b){var c=this;if(this.RS.$currentSlide.css("z-index",2),this.RS.$nextSlide.css({opacity:1,"z-index":1}),this.RS.cssTransitions?(this.RS.$currentSlide.find(".rs-caption").css("opacity",0),this.RS.$nextSlide.find(".rs-caption").css("opacity",1)):(this.RS.$currentSlide.find(".rs-caption").animate({opacity:0},c.RS.settings.transitionDuration),this.RS.$nextSlide.find(".rs-caption").animate({opacity:1},c.RS.settings.transitionDuration)),"function"==typeof this.setup){var d=this.setup();setTimeout(function(){b(d)},40)}else this.execute();this.RS.cssTransitions&&a(this.listenTo).one("webkitTransitionEnd transitionend oTransitionEnd msTransitionend MSTransitionEnd",function(){c.after()})},after:function(){this.RS.$slider.removeAttr("style"),this.RS.$currentSlide.removeAttr("style").css("opacity",0),this.RS.$nextSlide.removeAttr("style").css({"z-index":2,opacity:1}),"function"==typeof this.reset&&this.reset(),this.RS.settings.autoPlay&&(clearTimeout(this.RS.cycling),this.RS.setAutoPlay()),this.RS.$currentSlide=this.RS.$nextSlide,this.RS.inProgress=!1,this.RS.settings.afterChange()},fade:function(){var a=this;this.RS.cssTransitions?(this.setup=function(){a.listenTo=a.RS.$currentSlide,a.RS.$currentSlide.prefixes({transition:"opacity "+a.RS.settings.transitionDuration+"ms ease-in-out"})},this.execute=function(){a.RS.$currentSlide.css({opacity:0})}):this.execute=function(){a.RS.$currentSlide.animate({opacity:0},a.RS.settings.transitionDuration,function(){a.after()})},this.before(function(){a.execute()})},cube:function(a,b,c,d,e,f,g){if(!this.RS.cssTransitions||!this.RS.cssTransforms3d)return this[this.fallback3d]();var i=this;this.setup=function(){i.listenTo=i.RS.$slider,this.RS.$sliderBG.prefixes({perspective:1e3});var f={transform:"translateZ("+a+"px)","backface-visibility":"hidden"};i.RS.$currentSlide.prefixes(f),i.RS.$nextSlide.prefixes(f),i.RS.$slider.prefixes({transition:"none","transform-style":"preserve-3d",transform:"translateZ(-"+a+"px)"}),i.RS.$nextSlide.css({opacity:1}).prefixes({transform:"translateZ(0px) translateY("+c+"px) translateX("+b+"px) rotateY("+e+"deg) rotateX("+d+"deg)"})},this.execute=function(){for(var b=[],c=0;h.browserVendors.length>c;c++)b[h.browserVendors[c]+"transition"]=h.browserVendors[c]+"transform "+i.RS.settings.transitionDuration+"ms ease-in-out";i.RS.$slider.prefixes(b),i.RS.$slider.prefixes({transform:"translateZ(-"+a+"px) rotateX("+f+"deg) rotateY("+g+"deg)"})},this.before(function(){i.execute()})},cubeH:function(){var b=a(this.RS.$slides).width()/2;this.forward?this.cube(b,b,0,0,90,0,-90):this.cube(b,-b,0,0,-90,0,90)},cubeV:function(){var b=a(this.RS.$slides).height()/2;this.forward?this.cube(b,0,-b,90,0,-90,0):this.cube(b,0,b,-90,0,90,0)},grid:function(b,c,d,e,f,g,h){if(!this.RS.cssTransitions)return this[this.fallback]();var i=this;this.setup=function(){function g(b,c,e,f,g,h,j,k,l){var m=(k+l)*d;return a('<div class="rs-gridlet" />').css({width:b,height:c,top:e,left:f,"background-image":"url("+g+")","background-position":"-"+f+"px -"+e+"px","background-size":h+"px "+j+"px"}).prefixes({transition:"all "+i.RS.settings.transitionDuration+"ms ease-in-out "+m+"ms",transform:"none"})}var d=i.RS.settings.transitionDuration/(b+c);i.$img=i.RS.$currentSlide.find("img.rs-slide-image"),i.$grid=a("<div />").addClass("rs-grid"),i.RS.$currentSlide.prepend(i.$grid);var h=i.$img.width(),j=i.$img.height(),k=i.$img.attr("src"),l=Math.floor(h/b),m=Math.floor(j/c),n=h-b*l,o=Math.ceil(n/b),p=j-c*m,q=Math.ceil(p/c),r=0;e="auto"===e?h:e,e="min-auto"===e?-h:e,f="auto"===f?j:f,f="min-auto"===f?-j:f;for(var s=0;b>s;s++){var t=0,u=l;if(n>0){var v=n>=o?o:n;u+=v,n-=v}for(var w=0;c>w;w++){var x=m,y=p;y>0&&(v=y>=q?q:p,x+=v,y-=v),i.$grid.append(g(u,x,t,r,k,h,j,s,w)),t+=x}r+=u}i.listenTo=i.$grid.children().last(),i.$grid.show(),i.$img.css("opacity",0),i.$grid.children().first().addClass("rs-top-left"),i.$grid.children().last().addClass("rs-bottom-right"),i.$grid.children().eq(c-1).addClass("rs-bottom-left"),i.$grid.children().eq(-c).addClass("rs-top-right")},this.execute=function(){i.$grid.children().css("opacity",h).prefixes({transform:"rotate("+d+"deg) translateX("+e+"px) translateY("+f+"px) scale("+g+")"})},this.before(function(){i.execute()}),this.reset=function(){i.$img.css("opacity",1),i.$grid.remove()}},sliceH:function(){this.grid(1,8,0,"min-auto",0,1,0)},sliceV:function(){this.grid(10,1,0,0,"auto",1,0)},slideV:function(){this.grid(1,1,0,0,"auto",1,1)},slideH:function(){this.grid(1,1,0,"min-auto",0,1,1)},scale:function(){this.grid(1,1,0,0,0,1.5,0)},blockScale:function(){this.grid(8,6,0,0,0,.6,0)},kaleidoscope:function(){this.grid(10,8,0,0,0,1,0)},fan:function(){this.grid(1,10,45,100,0,1,0)},blindV:function(){this.grid(1,8,0,0,0,.7,0)},blindH:function(){this.grid(10,1,0,0,0,.7,0)},random:function(){this[this.anims[Math.floor(Math.random()*this.anims.length)]]()}};var h={browserVendors:["","-webkit-","-moz-","-ms-","-o-","-khtml-"],domPrefixes:["","Webkit","Moz","ms","O","Khtml"],testDom:function(a){for(var b=this.domPrefixes.length;b--;)if(c.body.style[this.domPrefixes[b]+a]!==d)return!0;return!1},cssTransitions:function(){return b.Modernizr&&Modernizr.csstransitions!==d?Modernizr.csstransitions:this.testDom("Transition")},cssTransforms3d:function(){return b.Modernizr&&Modernizr.csstransforms3d!==d?Modernizr.csstransforms3d:c.body.style.perspectiveProperty!==d?!0:this.testDom("Perspective")}};a.fn.prefixes=function(a){var b=[];for(var c in a)if(a.hasOwnProperty(c))for(var d=h.browserVendors.length;d--;)b[h.browserVendors[d]+c]=a[c];return this.css(b),this};var i="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==";a.fn.imagesLoaded=function(b){function l(){var d=a(j),f=a(k);e&&(k.length?e.reject(g,d,f):e.resolve(g)),a.isFunction(b)&&b.call(c,g,d,f)}function m(b,c){b.src!==i&&-1===a.inArray(b,h)&&(h.push(b),c?k.push(b):j.push(b),a.data(b,"imagesLoaded",{isBroken:c,src:b.src}),f&&e.notifyWith(a(b),[c,g,a(j),a(k)]),g.length===h.length&&(setTimeout(l),g.unbind(".imagesLoaded")))}var c=this,e=a.isFunction(a.Deferred)?a.Deferred():0,f=a.isFunction(e.notify),g=c.find("img").add(c.filter("img")),h=[],j=[],k=[];return g.length?g.bind("load.imagesLoaded error.imagesLoaded",function(a){m(a.target,"error"===a.type)}).each(function(b,c){var e=c.src,f=a.data(c,"imagesLoaded");return f&&f.src===e?(m(c,f.isBroken),d):c.complete&&c.naturalWidth!==d?(m(c,0===c.naturalWidth||0===c.naturalHeight),d):((c.readyState||c.complete)&&(c.src=i,c.src=e),d)}):l(),e?e.promise(c):c},a.fn.refineSlide=function(b){return this.each(function(){a.data(this,"refineSlide")||a.data(this,"refineSlide",new f(this,b))})}}(jQuery,window,document);